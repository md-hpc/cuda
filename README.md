# High Performance Molecular Dynamics on CUDA
**Molecular dynamics** is a technique in computational biology that simulates physical systems of interest at the particle level: integrating intermolecular forces using simple Newtonian mechanics over a series of discrete timesteps. Providing a rich understanding of the structure and dynamics of subject systems, these simulations are of great interest to biologists, and their extreme computational demand makes their optimization of great interest to computer engineers. While MD has some characteristics that lend themselves well to the highly parallel architectures of today's accelerators, the dense matrix of interactions when computing the short-range non-bonded Lenard Jones potential makes optimization of MD a nontrivial task. In this project, we develop optimizations for MD on three accelerators: CPU, GPU, and FPGA. The GPU code for this project lives here.

## Directory Structure
```
.
├── build                                          # executables are built and stored here
│   ├── cell_list
│   ├── cell_list_n3l
│   ├── naive
│   ├── nsquared
│   ├── nsquared_n3l
│   └── nsquared_shared
├── include                                        # header files
│   └── pdb_importer.h
├── input                                          # input PDB files generated by generate_pdb.py
│   ├── n-3000.pdb
│   ├── random_particles-1024.pdb
│   ├── random_particles-16384.pdb
│   ├── random_particles-4096.pdb
│   └── random_particles-65536.pdb
├── Makefile
├── output                                         # batch job outputs
│   ├── nsquared                                       # each implementation has a separate directory with csv, error, and output file
│   │   ├── ts-1_tsd-1e-15_n-3000_output.csv
│   │   ├── ts-1_tsd-1e-15_n-3000_output_error.txt
│   │   └── ts-1_tsd-1e-15_n-3000_output.txt
│   ├── nsquared_n3l
│   ├── nsquared_shared
│   ├── cell_list
│   └── cell_list_n3l
├── README.md
├── scripts
│   ├── batch_job.sh                                   # runs all jobs on the grid
│   ├── get_results.sh                                 # gets results from output files
│   └── script_generator.sh                            # generates batch job scripts into the scripts directory and also generated batch_job.sh
└── src                                            # implementations
    ├── cell_list.cu                                   # cell list
    ├── cell_list_n3l.cu                               # cell list with N3L optimization
    ├── generate_pdb.py                                # PDB file generator
    ├── naive.c                                        # C code for PoC
    ├── naive_with_cells.c                             # C code for PoC
    ├── nsquared.cu                                    # N^2
    ├── nsquared_n3l.cu                                # N^2 with N3L optimization
    ├── nsquared_shared.cu                             # N^2 with shared memory optimization
    ├── pdb_importer.c                                 # code for importing pdb files
    └── viz.py                                         # creates a gif from output file for SIMULATION mode
```
## Running CUDA
CUDA can be run on NVIDIA GPUs. For this project, A40 GPUs on the [BU Shared Computing Cluster](https://www.bu.edu/tech/support/research/system-usage/connect-scc/scc-ondemand/) are utilized.

### Running CUDA on the SCC
1. Login to an scc node.
2. Execute the command: `module load cuda/12.5` to load the NVIDIA sdk tools.
3. To compile cuda code, execute the command: `nvcc <filename> -o <outfile>`
4. To run the executable, a GPU node is needed. [interactive](https://www.bu.edu/tech/support/research/system-usage/running-jobs/interactive-jobs/)/[batch](https://www.bu.edu/tech/support/research/system-usage/running-jobs/submitting-jobs/#job-options)

## Resources
[CUDA C++ Programming Guide](https://docs.nvidia.com/cuda/cuda-c-programming-guide/)

[CUDA in C/C++ on the SCC](https://www.bu.edu/tech/support/research/software-and-programming/gpu-computing/cuda-c/)
